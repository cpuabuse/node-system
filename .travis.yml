language: node_js
node_js:
  - '12'
  - '11'
  - '10'
os:
  - windows
  - linux
  - osx
script:
  - git config core.autocrlf false & git add --renormalize .
jobs:
  include:
  - stage: Post test
    name: npm next release
    node_js: '12'
    deploy:
      email: cpuabuse@gmail.com
      provider: npm
      api_key:
        secure: rlPkaYcQDoaCVVWikzA15stbnVyF7XWficH32YvHlWO85WYnJuHwqG4kQsPAIjiKV4DV7lp9knPJ7vYcpQDEnptYEIUCegRI92kvvyd5jthfaMYCDlEYBEmLmiaLG/IGxpqXohqZuieaWJ37dMAvpneNxJWf8S91Xvl6sMQCk/aMTAvdk5MUKGDYU0JbtNqhEN7nC7Ra7+3GHbj4gJsYdIrvFRAo5Yy+EiMMP6q26TUNyUFTs8maFsPpZx2RGcBgmqzO0E/c3PeBKkJZG9ju0YVRdRpEFTKH+veum0fQlXGmY+38PJmUi/6N0QfWJAhjVeTYvF+ZC9mckwQSZv0ovkcH8VwsOsGjzQbuiYeFQ4i3F76esp+2ehGMItjHOMtS+cL7iR8GIsf3SkwocKHAKzim2i+V6pirWaYY9ujc54ldbUyty+jaRsRICq5gd4t47Uk7b8+972oxIhXxoXL1UtkDzWadlz3husX3rYVM/Lf2AjXTaUbKxOmp/v6BBzBPTM0NXwlGMVUTTv4O67p5qeev9oLpdvb25ZUvbR4xk5knSsniA1dzNxBL3wiqczSPmaxzY+RjcyrtUDfPyqopsfD1nuoLcBo/oKxCLIfbxrIWE4fgzcFdY37dU5MH0OyljR8J6nEoAwhOC1madVjaKM8qHsfnOUr2dE854dp7op8=
      on:
        branch: dev
        tags: true
      tag: next
  - name: coverage
    node_js: '12'
    script:
    - |-
      # Coverage
      npm run coverage
      cat ./coverage/lcov.info | node ./node_modules/coveralls/bin/coveralls.js
  - name: docs
    node_js: '12'
    script: npm run docs & npm run nojekyll
    deploy:
      provider: pages
      local_dir: docs/
      skip_cleanup: true
      github_token:
        secure: 4P2I/wayczxVSmDT+hKIizsufuztbgXnFCzFXU0ILd9373JqSYUYKgNL8XA5SshBlBI8rk1qfsN6aXVXJeY6K70dwm3u3no0oOhKyLjSZToi/vCpjTHQ5T9MDGm/HkeSHQbyn/EX5bd/ko348UuwpLj5FCXg8glyyIcji/nBjdTelLae7ftftUXA2fRmGWmR2WjerqPiIMW56EB5HES3sYDP9aEGWe8L2tmPjKycc+J0imKGtih13VOahDK5uRqLypFxQovBtcqRWDkDbB/jgwYER1DXb3CV3tVnLp6noKHENJ/WKgAjVEj7d+tW/t0D8+pwx+Y3hF6RHNVfaIC/11MWgfot9qDPgxHCHgbXT28lI46zchQyfURLZ0A6it1RAPTtIL0EsS5hy2YTkH7kN6jRC6Z5GR/non1zOn25+dhiPLiYS9auZviWMfnv++y8KqUO+Fi9Xye5tetHADqpqZxmf3ivPleZvcInsb/ECGulF4wVGg13tWAsz3b9PGesuzt5T+cXqP2c+phePzKSZjXDv8uELp3ioV6yZ6qSDqNoGDEwgKx3COTl5tXpGeHj6tJz8G2Bfs3OqgPvLoKreU5dyz7SKqRoLJUS/STIcMSufgZ6uYjZ/cUGgTgHtw2fjflsNDixq1wuNDue40m1w82ikAG0z28iVIlNPtYuWNE=
      keep_history: true
      on:
        branch: dev